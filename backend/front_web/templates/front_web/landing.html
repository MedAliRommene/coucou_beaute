{% extends 'base.html' %}
{% load static %}

{% block title %}Coucou Beauté - Accueil{% endblock %}

{% block extra_css %}
<style>
    .service-card {
        transition: transform .35s ease, box-shadow .35s ease, background-position .8s ease
    }

    .service-card:hover {
        transform: translateY(-6px);
        box-shadow: 0 20px 40px rgba(108, 169, 224, .18);
        background-position: right center
    }

    .pro-card {
        transition: transform .35s ease, box-shadow .35s ease
    }

    .pro-card:hover {
        transform: translateY(-6px);
        box-shadow: 0 20px 40px rgba(242, 139, 178, .18)
    }

    .pro-overlay {
        opacity: 0;
        transform: translateY(8px);
        transition: all .3s ease
    }

    .pro-card:hover .pro-overlay {
        opacity: 1;
        transform: translateY(0)
    }

    .star-anim {
        animation: twinkle 1.8s ease-in-out infinite
    }

    @keyframes twinkle {

        0%,
        100% {
            transform: scale(1);
            opacity: .9
        }

        50% {
            transform: scale(1.15);
            opacity: 1
        }
    }

    .carousel {
        position: relative;
        overflow: hidden
    }

    .carousel-track {
        display: flex;
        gap: 1rem;
        transition: transform .7s ease;
        will-change: transform
    }

    .map-iframe {
        transition: filter .3s ease
    }

    /* Glass modal */
    .modal {
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, .45);
        backdrop-filter: blur(10px);
        z-index: 60;
    }

    .modal.open {
        display: flex;
    }

    /* Hide dark mode toggle on landing */
    #themeToggle {
        display: none !important
    }
</style>
{% endblock %}

{% block content %}
<section class="relative overflow-hidden">
    <div class="absolute inset-0 bg-gradient-to-br from-pink-100 via-white to-blue-100"></div>
    <div class="absolute -top-24 -right-24 w-80 h-80 rounded-full bg-pink-200/50 blur-3xl"></div>
    <div class="absolute -bottom-24 -left-24 w-80 h-80 rounded-full bg-blue-200/50 blur-3xl"></div>
    <canvas id="hero3d" class="absolute inset-0 pointer-events-none" style="z-index:-1"></canvas>
    <div class="relative max-w-7xl mx-auto px-6 py-16">
        <!-- header provided by base; keep spacing only -->
        <div class="h-2"></div>

        <div class="mt-14 grid grid-cols-1 lg:grid-cols-2 gap-10 items-center">
            <div>
                <h1 class="text-4xl md:text-5xl font-extrabold leading-tight"><span id="typewriter"></span></h1>
                <p class="mt-4 text-gray-600">Trouvez des professionnelles près de chez vous, consultez leurs profils,
                    disponibilités et réservez en quelques clics.</p>
                <div class="mt-6 flex gap-3">
                    <a href="/login/"
                        class="px-5 py-3 rounded-xl bg-pink-500 text-white hover:bg-pink-600 shadow-sm">Commencer</a>
                    <a href="/signup/"
                        class="px-5 py-3 rounded-xl bg-[#86C5FF] text-white hover:brightness-95 shadow-sm">S'inscrire</a>
                    <a href="#services" class="px-5 py-3 rounded-xl bg-white border hover:bg-white">Découvrir</a>
                </div>
                <div class="mt-8 grid grid-cols-3 gap-4">
                    <div class="glass rounded-xl p-4 border tilt gradient-border">
                        <div class="flex items-center gap-2 text-2xl font-bold"><i data-lucide="star"
                                class="w-5 h-5 text-yellow-500"></i>4.8</div>
                        <div class="text-sm text-gray-600">Note moyenne</div>
                    </div>
                    <div class="glass rounded-xl p-4 border tilt gradient-border">
                        <div class="text-2xl font-bold">+1k</div>
                        <div class="text-sm text-gray-600">Rendez-vous / mois</div>
                    </div>
                    <div class="glass rounded-xl p-4 border tilt gradient-border">
                        <div class="text-2xl font-bold">24/7</div>
                        <div class="text-sm text-gray-600">Réservation</div>
                    </div>
                </div>
            </div>
            <div id="heroImg" class="bg-white rounded-2xl shadow-lg p-6 border float-slow will-change-transform">
                <img src="{{ MEDIA_URL }}image.png" alt="Beauty" class="rounded-xl w-full" />
            </div>
        </div>

        <section id="services" class="mt-20">
            <h2 class="text-2xl font-bold mb-6">Nos Services</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="service-card bg-white rounded-2xl p-5 border bg-gradient-to-r from-white to-white hover:from-rose-50 hover:to-blue-50"
                    data-aos="fade-up">
                    <div class="flex items-center gap-3 mb-1">
                        <div class="w-10 h-10 rounded-xl bg-pink-100 flex items-center justify-center overflow-hidden">
                            <div class="lottie-anim"
                                data-lottie="https://lottie.host/7c2b5b5c-63db-43e0-9b6a-3cc23e2d8c6d/Scissors.json"
                                style="width:24px;height:24px"></div>
                        </div>
                        <div class="font-medium">Coiffure</div>
                    </div>
                    <div class="text-sm text-gray-600">Coupe, brushing, coloration</div>
                </div>
                <div class="service-card bg-white rounded-2xl p-5 border bg-gradient-to-r from-white to-white hover:from-blue-50 hover:to-pink-50"
                    data-aos="fade-up">
                    <div class="flex items-center gap-3 mb-1">
                        <div class="w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center overflow-hidden">
                            <div class="lottie-anim"
                                data-lottie="https://lottie.host/2bfa8b59-5a69-4d8f-9d5f-f2e3d4a0f2b1/Sparkles.json"
                                style="width:24px;height:24px"></div>
                        </div>
                        <div class="font-medium">Esthétique</div>
                    </div>
                    <div class="text-sm text-gray-600">Soin visage, épilation</div>
                </div>
                <div class="service-card bg-white rounded-2xl p-5 border bg-gradient-to-r from-white to-white hover:from-green-50 hover:to-rose-50"
                    data-aos="fade-up">
                    <div class="flex items-center gap-3 mb-1">
                        <div class="w-10 h-10 rounded-xl bg-green-100 flex items-center justify-center overflow-hidden">
                            <div class="lottie-anim"
                                data-lottie="https://lottie.host/3f6edb2b-6c98-4b00-bc10-2d0383f0cc18/HandCare.json"
                                style="width:24px;height:24px"></div>
                        </div>
                        <div class="font-medium">Manucure</div>
                    </div>
                    <div class="text-sm text-gray-600">Vernis, gel, soins</div>
                </div>
                <div class="service-card bg-white rounded-2xl p-5 border bg-gradient-to-r from-white to-white hover:from-rose-50 hover:to-yellow-50"
                    data-aos="fade-up">
                    <div class="flex items-center gap-3 mb-1">
                        <div class="w-10 h-10 rounded-xl bg-rose-100 flex items-center justify-center overflow-hidden">
                            <div class="lottie-anim"
                                data-lottie="https://lottie.host/0b0c9b3c-0b58-4c3e-9e40-ff9b10bda2a6/Massage.json"
                                style="width:24px;height:24px"></div>
                        </div>
                        <div class="font-medium">Massage</div>
                    </div>
                    <div class="text-sm text-gray-600">Relaxant, thérapeutique</div>
                </div>
            </div>
        </section>

        <section id="professionals" class="mt-20">
            <h2 class="text-2xl font-bold mb-6">Nos Professionnels</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for i in "123456" %}
                <div class="pro-card rounded-2xl overflow-hidden border bg-white hover:shadow-xl transition relative"
                    data-aos="fade-up">
                    <div class="h-40 bg-gradient-to-br from-rose-100 to-amber-100"></div>
                    <div class="p-5">
                        <div class="flex items-center justify-between">
                            <h3 class="font-semibold">Nadia Benali</h3>
                            <div class="flex items-center gap-1 text-yellow-500">
                                <i data-lucide="star" class="w-4 h-4 star-anim"></i>
                                <i data-lucide="star" class="w-4 h-4 star-anim" style="animation-delay:.2s"></i>
                                <i data-lucide="star" class="w-4 h-4 star-anim" style="animation-delay:.4s"></i>
                                <i data-lucide="star" class="w-4 h-4 star-anim" style="animation-delay:.6s"></i>
                                <i data-lucide="star" class="w-4 h-4 star-anim" style="animation-delay:.8s"></i>
                            </div>
                        </div>
                        <p class="text-sm text-gray-600">Esthéticienne - Nabeul</p>
                        <div class="mt-3 flex gap-2 text-sm">
                            <a href="/booking/" class="px-3 py-1 rounded-lg bg-pink-100 text-pink-700">Réserver</a>
                            <button type="button" class="px-3 py-1 rounded-lg bg-gray-100" data-open="proModal">Voir le
                                profil</button>
                        </div>
                    </div>
                    <div class="pro-overlay absolute inset-0 bg-white/85 p-5">
                        <div class="font-medium mb-1">À propos</div>
                        <p class="text-sm text-gray-600">Bio: Passionnée par la beauté, 8 ans d'expérience, spécialiste
                            soins visage.</p>
                        <div class="mt-2 text-sm text-gray-700">Spécialités: Soins visage, épilation, massage.</div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

        <!-- Modal profil pro (glass) -->
        <div id="proModal" class="modal">
            <div class="bg-white/80 backdrop-blur-xl rounded-2xl border shadow-2xl w-[90%] max-w-xl p-6 relative">
                <button type="button"
                    class="absolute top-3 right-3 bg-white/70 border rounded-full w-8 h-8 flex items-center justify-center"
                    data-close>&times;</button>
                <div class="flex items-start gap-4">
                    <div class="w-20 h-20 rounded-xl bg-gradient-to-br from-rose-200 to-blue-200"></div>
                    <div class="flex-1">
                        <div class="text-lg font-semibold">Nadia Benali</div>
                        <div class="text-sm text-gray-600">Esthéticienne – Nabeul</div>
                        <div class="mt-2 text-sm">Bio courte: Passionnée par l'art de sublimer.</div>
                    </div>
                </div>
                <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                    <div class="bg-white/70 rounded-xl p-3 border">
                        <div class="font-medium mb-1">Spécialités</div>
                        <ul class="list-disc ml-5 text-gray-700">
                            <li>Soin visage</li>
                            <li>Massage relaxant</li>
                            <li>Épilation</li>
                        </ul>
                    </div>
                    <div class="bg-white/70 rounded-xl p-3 border">
                        <div class="font-medium mb-1">Réseaux</div>
                        <div class="flex gap-2"><span class="px-2 py-1 rounded bg-gray-100">Instagram</span><span
                                class="px-2 py-1 rounded bg-gray-100">Facebook</span></div>
                    </div>
                </div>
            </div>
        </div>

        <section id="testimonials" class="mt-20">
            <h2 class="text-2xl font-bold mb-6">Ils nous font confiance</h2>
            <div class="carousel bg-white/50 rounded-2xl border p-4">
                <div id="tTrack" class="carousel-track">
                    <div class="bg-white rounded-2xl border p-6 shadow-sm min-w-[280px]" data-index="0">
                        <div class="text-lg font-semibold">Marie Dubois</div>
                        <div class="text-yellow-500">★★★★★</div>
                        <p class="text-gray-600 mt-2">Service impeccable, accueil chaleureux et résultats parfaits.</p>
                        <div class="text-xs text-gray-400 mt-2">15 Jan 2025</div>
                    </div>
                    <div class="bg-white rounded-2xl border p-6 shadow-sm min-w-[280px]" data-index="1">
                        <div class="text-lg font-semibold">Sophie Martin</div>
                        <div class="text-yellow-500">★★★★★</div>
                        <p class="text-gray-600 mt-2">Très professionnelle et à l'écoute, je recommande.</p>
                        <div class="text-xs text-gray-400 mt-2">16 Jan 2025</div>
                    </div>
                    <div class="bg-white rounded-2xl border p-6 shadow-sm min-w-[280px]" data-index="2">
                        <div class="text-lg font-semibold">Anne Leroy</div>
                        <div class="text-yellow-500">★★★★★</div>
                        <p class="text-gray-600 mt-2">Réservation simple et rapide, expérience parfaite.</p>
                        <div class="text-xs text-gray-400 mt-2">18 Jan 2025</div>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact" class="mt-20">
            <h2 class="text-2xl font-bold mb-6">Nous contacter</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <form class="bg-white rounded-2xl border p-6 space-y-3">
                    <input class="w-full border rounded-xl px-3 py-2" placeholder="Nom complet" />
                    <input class="w-full border rounded-xl px-3 py-2" placeholder="Email" type="email" />
                    <textarea class="w-full border rounded-xl px-3 py-2" rows="4"
                        placeholder="Votre message"></textarea>
                    <button class="px-5 py-2 rounded-xl bg-pink-500 text-white hover:bg-pink-600">Envoyer</button>
                </form>
                <div class="bg-white rounded-2xl border p-2">
                    <iframe id="gmap" title="map" class="map-iframe w-full h-[300px] rounded-xl" loading="lazy"
                        allowfullscreen
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3239.493!2d10.735!3d36.451!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2z!5e0!3m2!1sfr!2stn!4v1700000000000"></iframe>
                </div>
            </div>
        </section>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="https://unpkg.com/lucide@latest"></script>
<script>
    window.lucide && window.lucide.createIcons();
</script>
<!-- Three.js + Lottie + GSAP -->
<script src="https://unpkg.com/three@0.158.0/build/three.min.js"></script>
<script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
<script src="https://unpkg.com/gsap@3.12.5/dist/gsap.min.js"></script>
<script>
    // Typewriter headline
    (function () {
        const el = document.getElementById('typewriter'); if (!el) return;
        const text = "Réservez vos soins beauté en toute simplicité"; let i = 0;
        function tick() { el.textContent = text.slice(0, ++i); if (i < text.length) setTimeout(tick, 40); }
        tick();
    })();
    // Parallax hero image
    (function () {
        const img = document.getElementById('heroImg'); if (!img) return;
        window.addEventListener('scroll', () => { const y = window.scrollY; img.style.transform = `translateY(${y * 0.06}px)`; }, { passive: true });
    })();
    // Testimonials auto-carousel
    (function () {
        const track = document.getElementById('tTrack'); if (!track) return; let idx = 0; const cards = [...track.children];
        function go(n) { idx = (n % cards.length + cards.length) % cards.length; const w = cards[0].offsetWidth + 16; track.style.transform = `translateX(${-idx * w}px)`; }
        setInterval(() => go(idx + 1), 3000); window.addEventListener('resize', () => go(idx));
    })();
    // Map style sync with dark mode
    (function () {
        const m = document.getElementById('gmap'); if (!m) return; function apply() { const dark = document.documentElement.classList.contains('dark'); m.style.filter = dark ? 'invert(0.9) hue-rotate(180deg) brightness(0.9)' : 'none'; }
        apply(); const t = document.getElementById('themeToggle'); if (t) t.addEventListener('click', () => setTimeout(apply, 10));
    })();
    // Three.js aurora/particles background
    (function () {
        const canvas = document.getElementById('hero3d'); if (!canvas || !window.THREE) return;
        const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
        const scene = new THREE.Scene(); const camera = new THREE.PerspectiveCamera(55, innerWidth / innerHeight, 0.1, 100); camera.position.z = 9;
        renderer.setPixelRatio(Math.min(devicePixelRatio, 2)); renderer.setSize(innerWidth, innerHeight);
        const amb = new THREE.AmbientLight(0xffffff, 0.9); scene.add(amb);
        function auroraTex() { const s = 256, c = document.createElement('canvas'); c.width = c.height = s; const x = c.getContext('2d'); const g = x.createLinearGradient(0, 0, s, s); g.addColorStop(0, 'rgba(108,169,224,.55)'); g.addColorStop(.5, 'rgba(242,139,178,.45)'); g.addColorStop(1, 'rgba(201,162,39,.35)'); x.fillStyle = g; x.beginPath(); x.arc(s / 2, s / 2, s / 2, 0, Math.PI * 2); x.fill(); return new THREE.CanvasTexture(c); }
        const geo = new THREE.PlaneGeometry(18, 10, 64, 64); const mat = new THREE.MeshBasicMaterial({ map: auroraTex(), transparent: true, opacity: 0.6 }); const aurora = new THREE.Mesh(geo, mat); aurora.position.z = -2; scene.add(aurora);
        const group = new THREE.Group(); scene.add(group); const pgeo = new THREE.SphereGeometry(0.03, 6, 6); const pm = new THREE.MeshBasicMaterial({ color: 0xffffff });
        for (let i = 0; i < 220; i++) { const m = new THREE.Mesh(pgeo, pm); m.position.set((Math.random() - 0.5) * 18, (Math.random() - 0.2) * 10, -1.5 - Math.random()); m.userData = { vy: 0.005 + Math.random() * 0.005 }; group.add(m); }
        function onResize() { camera.aspect = innerWidth / innerHeight; camera.updateProjectionMatrix(); renderer.setSize(innerWidth, innerHeight); } window.addEventListener('resize', onResize);
        let t = 0; function loop() { requestAnimationFrame(loop); t += 0.005; aurora.rotation.z = Math.sin(t) * 0.08; group.children.forEach(p => { p.position.y += p.userData.vy; if (p.position.y > 5) { p.position.y = -3 - Math.random() * 2; } }); renderer.render(scene, camera); } loop();
    })();
    // Lottie icons for services
    (function () { const map = { scissors: 'https://assets8.lottiefiles.com/packages/lf20_1pxqjqps.json', sparkles: 'https://assets7.lottiefiles.com/packages/lf20_9wjm14ni.json', hand: 'https://assets3.lottiefiles.com/packages/lf20_0yfsb3a1.json', heart: 'https://assets10.lottiefiles.com/packages/lf20_9xcyasrh.json' }; document.querySelectorAll('.lottie-anim').forEach(el => { const k = el.getAttribute('data-lottie'); const src = map[k]; if (!src) return; const p = document.createElement('lottie-player'); p.setAttribute('src', src); p.setAttribute('background', 'transparent'); p.setAttribute('speed', '1'); p.style.width = '100%'; p.style.height = '100%'; p.setAttribute('loop', ''); p.setAttribute('autoplay', ''); el.appendChild(p); }); })();
    // Modal open/close
    (function () { const modal = document.getElementById('proModal'); if (!modal) return; document.querySelectorAll('[data-open="proModal"]').forEach(b => b.addEventListener('click', () => modal.classList.add('open'))); modal.querySelector('[data-close]')?.addEventListener('click', () => modal.classList.remove('open')); modal.addEventListener('click', (e) => { if (e.target === modal) modal.classList.remove('open'); }); })();
    // GSAP hover depth on testimonials
    (function () { const track = document.getElementById('tTrack'); if (!track || !window.gsap) return;[...track.children].forEach(card => { card.style.transformStyle = 'preserve-3d'; card.addEventListener('mouseenter', () => gsap.to(card, { duration: .3, scale: 1.05, rotateY: 6 })); card.addEventListener('mouseleave', () => gsap.to(card, { duration: .3, scale: 1, rotateY: 0 })); }); })();
</script>
{% endblock %}